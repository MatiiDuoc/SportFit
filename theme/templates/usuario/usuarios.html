{% extends "base.html" %}

{% block title %}
Gestión de Usuarios
{% endblock %}

{% block navbar %}
{% include "components/admin_navbar.html" %}
{% endblock %}

{% block footer %}
<!-- Dejar vacío para no cargar el footer del cliente -->
{% endblock %}

{% block content %}
{% include "components/modals.html" with modal_id="userModal" %}

<!-- Botón para mostrar la sidebar en pantallas pequeñas -->
<button id="toggleSidebar" class="sm:hidden fixed top-4 left-4 z-50 bg-blue-500 text-white p-2 rounded shadow-lg">
    <i class="fa-solid fa-bars"></i>
</button>

<div class="flex flex-col sm:flex-row min-h-screen">


    <!-- Contenido principal -->
    <div id="mainContent" class="flex-grow p-4 sm:p-6 bg-gray-100 transition-all duration-300 ease-in-out">
        <h1 class="text-xl sm:text-2xl font-bold mb-4 sm:mb-6 text-gray-800">Usuarios registrados</h1>
        {% include "components/filters-user.html" %}


        <div class="mt-2 mb-4 flex justify-end">
            <button id="openModal" class="bg-blue-500 text-white px-4 sm:px-6 py-2 rounded hover:bg-blue-600 transition"
                onclick="showModal(
                    'userModal', 
                    'Agregar Usuario',
                    `<form id='addUserForm' onsubmit='return validateForm()'>
                        <div class='grid grid-cols-1 sm:grid-cols-2 gap-4'>
                            <div>
                                <label for='rut' class='block text-sm font-medium text-gray-700'>Rut</label>
                                <input type='text' id='rut' name='rut' class='w-full border border-gray-300 rounded-lg p-2 mt-1' required>
                            </div>
                            <div>
                                <label for='name' class='block text-sm font-medium text-gray-700'>Nombre</label>
                                <input type='text' id='name' name='name' class='w-full border border-gray-300 rounded-lg p-2 mt-1' required>
                            </div>
                            <div>
                                <label for='email' class='block text-sm font-medium text-gray-700'>Email</label>
                                <input type='email' id='email' name='email' class='w-full border border-gray-300 rounded-lg p-2 mt-1' required>
                            </div>
                            <div>
                                <label for='role' class='block text-sm font-medium text-gray-700'>Rol</label>
                                <select id='role' name='role' class='w-full border border-gray-300 rounded-lg p-2 mt-1' required>
                                    <option value='Administrador'>Administrador</option>
                                    <option value='Usuario'>Usuario</option>
                                </select>
                            </div>
                            <div>
                                <label for='password' class='block text-sm font-medium text-gray-700'>Contraseña</label>
                                <input type='password' id='password' name='password' class='w-full border border-gray-300 rounded-lg p-2 mt-1' required>
                            </div>
                            <div>
                                <label for='confirm_password' class='block text-sm font-medium text-gray-700'>Confirmar Contraseña</label>
                                <input type='password' id='confirm_password' name='confirm_password' class='w-full border border-gray-300 rounded-lg p-2 mt-1' required>
                            </div>
                            <div>
                                <label for='phone' class='block text-sm font-medium text-gray-700'>Teléfono</label>
                                <input type='text' id='phone' name='phone' class='w-full border border-gray-300 rounded-lg p-2 mt-1'>
                            </div>
                            <div>
                                <label for='phone-emergencia' class='block text-sm font-medium text-gray-700'>Teléfono emergencia</label>
                                <input type='text' id='phone-emergencia' name='phone-emergencia' class='w-full border border-gray-300 rounded-lg p-2 mt-1'>
                            </div>
                            <div>
                                <label for='address' class='block text-sm font-medium text-gray-700'>Dirección</label>
                                <input type='text' id='address' name='address' class='w-full border border-gray-300 rounded-lg p-2 mt-1'>
                            </div>
                            <div>
                                <label for='birthdate' class='block text-sm font-medium text-gray-700'>Fecha de Nacimiento</label>
                                <input type='date' id='birthdate' name='birthdate' class='w-full border border-gray-300 rounded-lg p-2 mt-1'>
                            </div>
                            <div>
                                <label for='profile_image' class='block text-sm font-medium text-gray-700'>Imagen de Perfil</label>
                                <input type='file' id='profile_image' name='profile_image' class='w-full border border-gray-300 rounded-lg p-2 mt-1'>
                            </div>
                        </div>
                    </form>`,
                    'Guardar'
                )">
                Agregar Usuario
            </button>
        </div>

        <!-- Tabla responsiva -->
        <div class="overflow-x-auto bg-white border border-gray-300 rounded-lg shadow-md">
            <table class="min-w-full border-collapse border border-gray-300 rounded-lg overflow-hidden">
                <thead>
                    <tr class="bg-gray-200 text-gray-700">
                        <th scope="col" class="px-2 sm:px-4 py-2 text-left font-semibold border-b border-gray-300">ID
                        </th>
                        <th scope="col" class="px-2 sm:px-4 py-2 text-left font-semibold border-b border-gray-300">
                            Nombre</th>
                        <th scope="col" class="px-2 sm:px-4 py-2 text-left font-semibold border-b border-gray-300">Email
                        </th>
                        <th scope="col" class="px-2 sm:px-4 py-2 text-left font-semibold border-b border-gray-300">Rol
                        </th>
                        <th scope="col" class="px-2 sm:px-4 py-2 text-left font-semibold border-b border-gray-300">Fecha
                            de Registro</th>
                        <th scope="col" class="px-2 sm:px-4 py-2 text-left font-semibold border-b border-gray-300">
                            Imagen de perfil</th>
                        <th scope="col" class="px-2 sm:px-4 py-2 text-left font-semibold border-b border-gray-300">
                            Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="border-b hover:bg-gray-100 transition">
                        <td class="px-2 sm:px-4 py-2 text-gray-800">1</td>
                        <td class="px-2 sm:px-4 py-2 text-gray-800">Juan Pérez</td>
                        <td class="px-2 sm:px-4 py-2 text-gray-800">juan.perez@example.com</td>
                        <td class="px-2 sm:px-4 py-2 text-gray-800">Administrador</td>
                        <td class="px-2 sm:px-4 py-2 text-gray-800">2023-01-15</td>
                        <td class="px-2 sm:px-4 py-2">
                            <img src="https://via.placeholder.com/40" alt="Perfil" class="w-10 h-10 rounded-full">
                        </td>
                        <td class="px-2 sm:px-4 py-2 flex flex-wrap gap-2">
                            <!-- Botón Ver -->
                            <button
                                class="bg-blue-500 text-white px-2 sm:px-3 py-1 rounded hover:bg-blue-600 transition flex items-center space-x-1"
                                onclick="showModal('userModal', 'Ver Usuario', `
                                    <p><strong>ID:</strong> 1</p>
                                    <p><strong>Nombre:</strong> Juan Pérez</p>
                                    <p><strong>Email:</strong> juan.perez@example.com</p>
                                    <p><strong>Rol:</strong> Administrador</p>
                                    <p><strong>Teléfono:</strong> 123456789</p>
                                    <p><strong>Teléfono de Emergencia:</strong> 987654321</p>
                                    <p><strong>Dirección:</strong> Calle Falsa 123</p>
                                    <p><strong>Fecha de Nacimiento:</strong> 1990-01-01</p>
                                    <img src='https://via.placeholder.com/100' alt='Usuario' class='mt-4 rounded'>
                                `, 'Cerrar')">
                                <i class="fa-solid fa-eye"></i>
                                <span>Ver</span>
                            </button>
                            <!-- Botón Editar -->
                            <button
                                class="bg-yellow-500 text-white px-2 sm:px-3 py-1 rounded hover:bg-yellow-600 transition flex items-center space-x-1"
                                onclick="showModal('userModal', 'Editar Usuario', `
                                    <form id='editUserForm' onsubmit='return validateForm()'>
                                        <div class='grid grid-cols-1 sm:grid-cols-2 gap-4'>
                                            <div>
                                                <label for='edit_name' class='block text-sm font-medium text-gray-700'>Nombre</label>
                                                <input type='text' id='edit_name' name='name' value='Juan Pérez' class='w-full border border-gray-300 rounded-lg p-2 mt-1' required>
                                            </div>
                                            <div>
                                                <label for='edit_email' class='block text-sm font-medium text-gray-700'>Email</label>
                                                <input type='email' id='edit_email' name='email' value='juan.perez@example.com' class='w-full border border-gray-300 rounded-lg p-2 mt-1' required>
                                            </div>
                                            <div>
                                                <label for='edit_role' class='block text-sm font-medium text-gray-700'>Rol</label>
                                                <select id='edit_role' name='role' class='w-full border border-gray-300 rounded-lg p-2 mt-1' required>
                                                    <option value='Administrador' selected>Administrador</option>
                                                    <option value='Usuario'>Usuario</option>
                                                </select>
                                            </div>
                                            <div>
                                                <label for='edit_phone' class='block text-sm font-medium text-gray-700'>Teléfono</label>
                                                <input type='text' id='edit_phone' name='phone' value='123456789' class='w-full border border-gray-300 rounded-lg p-2 mt-1'>
                                            </div>
                                            <div>
                                                <label for='edit_phone_emergencia' class='block text-sm font-medium text-gray-700'>Teléfono de Emergencia</label>
                                                <input type='text' id='edit_phone_emergencia' name='phone_emergencia' value='987654321' class='w-full border border-gray-300 rounded-lg p-2 mt-1'>
                                            </div>
                                            <div>
                                                <label for='edit_address' class='block text-sm font-medium text-gray-700'>Dirección</label>
                                                <input type='text' id='edit_address' name='address' value='Calle Falsa 123' class='w-full border border-gray-300 rounded-lg p-2 mt-1'>
                                            </div>
                                            <div>
                                                <label for='edit_birthdate' class='block text-sm font-medium text-gray-700'>Fecha de Nacimiento</label>
                                                <input type='date' id='edit_birthdate' name='birthdate' value='1990-01-01' class='w-full border border-gray-300 rounded-lg p-2 mt-1'>
                                            </div>
                                            <div>
                                                <label for='edit_profile_image' class='block text-sm font-medium text-gray-700'>Imagen de Perfil</label>
                                                <input type='file' id='edit_profile_image' name='profile_image' class='w-full border border-gray-300 rounded-lg p-2 mt-1'>
                                            </div>
                                        </div>
                                    </form>
                                `, 'Guardar Cambios')">
                                <i class="fa-solid fa-pen"></i>
                                <span>Editar</span>
                            </button>
                            <!-- Botón Eliminar -->
                            <button
                                class="bg-red-500 text-white px-2 sm:px-3 py-1 rounded hover:bg-red-600 transition flex items-center space-x-1"
                                onclick="showModal('userModal', 'Eliminar Usuario', `
                                    <p>¿Estás seguro de que deseas eliminar este usuario?</p>
                                    <p><strong>Nombre:</strong> Juan Pérez</p>
                                    <p><strong>ID:</strong> 1</p>
                                `, 'Eliminar')">
                                <i class="fa-solid fa-trash"></i>
                                <span>Eliminar</span>
                            </button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        {% include "components/paginator.html" %}
    </div>
</div>

{% endblock %}